---
title: "Hands-on Exercise 2"
author: "SHIH, HUA-HSUAN"
---

# 2.2 Getting Started

## 2.2.1 Installing and loading the required libraries
```{r include=FALSE}
remotes::install_git("https://codeberg.org/hrbrmstr/hrbrthemes.git")
```

```{r}
pacman::p_load(ggrepel,patchwork, ggthemes,hrbrthemes, tidyverse)
```
Already remote install hrbrthemes, hide it with '{r incluse=False}'.

## 2.2.2 Importing data
```{r}
exam_data <- read_csv("data/Exam_data.csv")
```

# 2.3 Beyond ggplot2 Annotation: ggrepel
```{r}
ggplot(data=exam_data,  
       aes(x= MATHS, 
           y=ENGLISH)) +
  geom_point() +
  geom_smooth(method=lm, 
              linewidth=0.5) +
  geom_label(aes(label = ID), 
             hjust = .5, 
             vjust = -.5) +
  coord_cartesian(xlim=c(0,100),
                  ylim=c(0,100)) +
  ggtitle("English scores versus Maths scores for Primary 3")
```
memo: 
1. change 'size' into 'linewidth' because of updating version. 2.'geom_point' means each record have their own point. 3.'geom_smooth' means drawing trend line. lm= linear model 4.'geom_label' means each point add with ID text beside 5.'coord_cartesian' only show the score from 0 to 10 6.'ggtitle': add the title

## 2.3.1 Working with ggrepel
```{r}
ggplot(data=exam_data, 
       aes(x= MATHS, 
           y=ENGLISH)) +
  geom_point() +
  geom_smooth(method=lm, 
              size=0.5) +  
  geom_label_repel(aes(label = ID), 
                   fontface = "bold") +
  coord_cartesian(xlim=c(0,100),
                  ylim=c(0,100)) +
  ggtitle("English scores versus Maths scores for Primary 3")
```
memo: using 'geom_label_rebel' prevent overlapping labels

# 2.4 Beyond ggplot2 Themes
```{r}
ggplot(data = exam_data,      # 使用考試資料
       aes(x = MATHS)) +      # X 軸為數學成績
  geom_histogram(bins = 20,   # 分成 20 個區間
                 boundary = 100,  # 以 100 作為切割邊界
                 color = "grey25", # 長條邊框顏色
                 fill = "grey90") + # 長條填滿顏色
  theme_gray() +              # 使用 ggplot 預設主題
  ggtitle("Distribution of Maths scores")  # 圖表標題
```

## 2.4.1 Working with ggtheme package
```{r}
ggplot(data = exam_data,        # 使用 exam_data 作為資料來源
       aes(x = MATHS)) +        # 指定 X 軸為數學成績
  geom_histogram(bins = 20,     # 將數學成績分成 20 個區間
                 boundary = 100, # 以 100 作為直方圖的分箱邊界
                 color = "grey25", # 長條圖邊框顏色（深灰）
                 fill = "grey90") + # 長條圖填滿顏色（淺灰）
  ggtitle("Distribution of Maths scores") + # 圖表標題
  theme_economist()             # 套用 Economist 風格主題（來自 ggthemes）
```

## 2.4.2 Working with hrbthems package
```{r warning=FALSE}
ggplot(data = exam_data,        # 使用 exam_data 作為資料來源
       aes(x = MATHS)) +        # 指定 X 軸為數學成績
  geom_histogram(bins = 20,     # 將數學成績分成 20 個區間
                 boundary = 100, # 以 100 作為分箱的邊界（符合成績上限）
                 color = "grey25", # 直方圖邊框顏色（深灰）
                 fill = "grey90") + # 直方圖填滿顏色（淺灰）
  ggtitle("Distribution of Maths scores") + # 設定圖表標題
  theme_ipsum()                # 套用 hrbrthemes 的 ipsum 主題（簡潔、無多餘格線）
```
memo: font issue still can't solve, so setting warning=FALSE to avoid messing interface

```{r}
ggplot(data = exam_data,            # 使用 exam_data 作為資料來源
       aes(x = MATHS)) +            # 指定 X 軸為數學成績
  geom_histogram(bins = 20,         # 將數學成績分成 20 個區間
                 boundary = 100,    # 以 100 作為分箱邊界（符合成績上限）
                 color = "grey25",  # 直方圖邊框顏色（深灰）
                 fill = "grey90") + # 直方圖填滿顏色（淺灰）
  ggtitle("Distribution of Maths scores") + # 設定圖表標題
  theme_ipsum(axis_title_size = 18, # 設定座標軸標題字體大小
              base_size = 15,       # 設定整體字體的基準大小
              grid = "Y")           # 僅顯示 Y 軸格線，提升讀值可讀性
```

# 2.5 Beyond Single Graph
```{r warning=FALSE}
# picture 1
p1 <- ggplot(data=exam_data, 
             aes(x = MATHS)) +
  geom_histogram(bins=20, 
                 boundary = 100,
                 color="grey25", 
                 fill="grey90") + 
  coord_cartesian(xlim=c(0,100)) +
  ggtitle("Distribution of Maths scores")

#picture 2
p2 <- ggplot(data=exam_data, 
             aes(x = ENGLISH)) +
  geom_histogram(bins=20, 
                 boundary = 100,
                 color="grey25", 
                 fill="grey90") +
  coord_cartesian(xlim=c(0,100)) +
  ggtitle("Distribution of English scores")


#picture 3
p3 <- ggplot(data=exam_data, 
             aes(x= MATHS, 
                 y=ENGLISH)) +
  geom_point() +
  geom_smooth(method=lm, 
              size=0.5) +  
  coord_cartesian(xlim=c(0,100),
                  ylim=c(0,100)) +
  ggtitle("English scores versus Maths scores for Primary 3")

# 輸出組合圖
p1 + p2
(p1 / p2) | p3

# 幫子圖自動加「編號標籤」
((p1 / p2) | p3) + 
  plot_annotation(tag_levels = 'I')

# 以 p3 當主圖，然後把 p2 當成「小視窗」，嵌在 p3 的左上角。
p3 + inset_element(p2, 
                   left = 0.02, 
                   bottom = 0.7, 
                   right = 0.5, 
                   top = 1)

#先把三張圖組成一張「組合圖」，再用 & 一次把同一個 theme 套用到所有子圖。
patchwork <- (p1 / p2) | p3
patchwork & theme_economist()
```
